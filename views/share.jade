extends layout

block content
  #joinGame.content
    .card
      .item.item-divider Share URL or Code
      .item.item-text-wrap
        .item.item-input-inset
          label.item-input-wrapper
            input#copyCode(style="width: 100%;padding-left: 0px;padding-top: 1px;" type="text", value=domain_url+"/join/"+code)
          button#copyBtn.button.button-small.button-positive Copy
    .card
      .item.item-divider Players in the room 1 of #{num_players}
      .item.item-text-wrap
        ul#players.list
  #game.content(style="display: none;")
    //- a( href=domain_url+"/game/"+code+"/#{player.id}")=player.nickname
    .clearfix
      .content-hex
        .top
          a.hexagon( onClick="inputGame(1)" style='background: #{colors[1]}')
          a.hexagon( onClick="inputGame(2)" style='background: #{colors[2]}')
        .bottom
          a.hexagon( onClick="inputGame(3)" style='background: #{colors[3]}')
          a.hexagon( onClick="inputGame(4)" style='background: #{colors[4]}')
          a.hexagon( onClick="inputGame(5)" style='background: #{colors[5]}')
        .top
          a.hexagon( onClick="inputGame(6)" style='background: #{colors[6]}')
          a.hexagon( onClick="inputGame(7)" style='background: #{colors[7]}')
    .card
      pre#gameInfo

  #bar.bar.bar-footer.bar-dark(style="display: none;")
    .title Recuerda los colores

  script.
    $( "#copyBtn" ).on( "click", function() {
      $('#copyCode').select();
      document.execCommand('copy'); // or 'cut'
    });
  script.
    var socket = io.connect(window.location.host);
                // black  // green  // yellow // blue   // pulpure // aqua    // red    // gray
    var colors = ['#000000','#28a54c','#ffc900','#ffc900','#6b46e5' ,'#0a9dc7' ,'#e42112','#686868'];
    
    function inputGame(value){
      socket.emit('inputGame',{gameCode: '#{code}',input:value,playerID : '#{player.id}'});
    }
    socket.emit('joinPlayer',{gameCode: "#{code}" , playerID : '#{player.id}'});
    socket.on('joinPlayer', function (data) {
      $('#players').empty();
      for(var i=0; i<data.players.length;i++){
        $('#players').append('<li class="item">'+data.players[i].nickname+'</li>')
      }
    });
    socket.on('gotoGame',function(data){
      $('#gameInfo').text(JSON.stringify(data.game,1,' '));
      $('#joinGame').hide();
      $('#game').show();
      $('#bar').show();
    });

    socket.on('background',function(data){
      $('body').css("background-color", colors[data.colorNum] || 'rgb(231, 231, 231)');
    });

    socket.on('youTrun',function(data){
      $('#bar').removeClass('bar-dark bar-balanced')
               .addClass( (data.value && 'bar-balanced') || 'bar-dark');
      $('#bar .title').text( (data.value && 'Tu Turno') || 'Otro jugador' );
    });

    socket.on('winOrLost',function(data){
      $('#bar').removeClass('bar-balanced bar-dark')
               .addClass( (data.value && 'bar-positive') || 'bar-assertive');
      $('#bar .title').text( (data.value && 'Winner') || 'Loser' );
    });
